function yi2  = intrpf2( xi, x, y )
% Function to interpolate between data points 
%   x    Vector of x coordinates of data points (4 values) 
%   y    Vector of y coordinates of data points (4 values) 
%   xi   The x value where interpolation is computed
%   yi   The interpolation polynomial evaluated at xi

a = (-x(3)^4 * x(4) * y(2) + x(2)^5 * y(3) - x(2)^2 * x(3)^3 * y(3) ...
    + x(2) * x(3)^3 * (x(3) * y(2) + x(4) * y(3)) + x(2)^3 * x(3) ... 
    * (x(4) * y(3) + x(3) * (y(2) - y(4))) - x(2)^4 * (x(4)* y(3) ... 
    + x(3) * (y(2) + y(3) - y(4))))/((x(2) - x(3))^2 * (x(2)^2 + x(2) ... 
    * x(3) + x(3)^2) * (x(2) - x(4)));

b = (2*x(3)^3 * x(4) * (y(2) - y(3)) + 2*x(2)^3 * x(3) * (-y(2) + y(3)) ... 
    - x(2)^2 * x(3) * (2*x(4) * (-y(2) + y(3)) + x(3) * (2*y(2) ...
    + y(3) - 3*y(4))) + 2*x(2)^4 * (y(2) - y(4)) - x(2) * x(3)^2 ...
    * (x(4) * (y(2) - y(3)) + x(3) * (y(2) - 2*y(3) + y(4))) ... 
    / (2*(x(2) - x(3))^2 * (x(2)^2 + x(2) * x(3) + x(3)^2) ...
    * (x(2) - x(4))));
    
c = -(((2*x(2) + x(3)) * (x(4) * (y(2) - y(3)) + x(2) * (y(3) - y(4)) ...
    + x(3) * (-y(2) + y(4))/(2*(x(2)^3 - x(3)^3) * (x(2) - x(4))))));

d = (x(3) * (x(4) * (-y(2) + y(3)) + x(3) * (y(2) - y(4)) + x(2) ...
    * (-y(3) + y(4))))/(2*(x(2) - x(3))^2 * (x(2)^2 + x(2) * x(3) ... 
    + x(3)^2) * (x(2) - x(4)));

yi2 = a + b*xi + c*xi^2 + d*xi^3;
return;
